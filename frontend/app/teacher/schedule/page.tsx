'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useAuthStore } from '@/store/useAuthStore';\nimport { Calendar, Clock, MapPin, Users } from 'lucide-react';\n\ninterface ScheduleData {\n    schedule: Array<{\n        day: string;\n        classes: Array<{\n            id: string;\n            groupName: string;\n            subject: string;\n            level: string;\n            startTime: string;\n            endTime: string;\n            room?: string;\n            studentCount: number;\n        }>;\n    }>;\n    weekDates: {\n        start: string;\n        end: string;\n    };\n}\n\nexport default function TeacherSchedule() {\n    const [scheduleData, setScheduleData] = useState<ScheduleData | null>(null);\n    const [currentWeek, setCurrentWeek] = useState(0); // 0 = current week, 1 = next week, -1 = previous week\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        fetchScheduleData();\n    }, [currentWeek]);\n\n    const fetchScheduleData = async () => {\n        try {\n            const token = useAuthStore.getState().accessToken;\n            const response = await fetch(`/api/teacher/schedule?week=${currentWeek}`, {\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                },\n            });\n\n            if (response.ok) {\n                const data = await response.json();\n                setScheduleData(data);\n            }\n        } catch (error) {\n            console.error('Error fetching schedule data:', error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const getDayName = (day: string): string => {\n        const days: Record<string, string> = {\n            'MONDAY': 'Lundi',\n            'TUESDAY': 'Mardi', \n            'WEDNESDAY': 'Mercredi',\n            'THURSDAY': 'Jeudi',\n            'FRIDAY': 'Vendredi',\n            'SATURDAY': 'Samedi',\n            'SUNDAY': 'Dimanche'\n        };\n        return days[day] || day;\n    };\n\n    const getTimeColor = (startTime: string): string => {\n        const hour = parseInt(startTime.split(':')[0]);\n        if (hour < 12) return 'bg-blue-100 text-blue-800';\n        if (hour < 16) return 'bg-green-100 text-green-800';\n        return 'bg-purple-100 text-purple-800';\n    };\n\n    if (loading) {\n        return (\n            <div className=\"flex items-center justify-center min-h-64\">\n                <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500\"></div>\n            </div>\n        );\n    }\n\n    const totalClasses = scheduleData?.schedule.reduce((total, day) => total + day.classes.length, 0) || 0;\n    const totalStudents = scheduleData?.schedule.reduce((total, day) => \n        total + day.classes.reduce((dayTotal, class_) => dayTotal + class_.studentCount, 0), 0\n    ) || 0;\n\n    return (\n        <div className=\"space-y-6\">\n            {/* Header */}\n            <div className=\"bg-white rounded-lg shadow p-6\">\n                <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-3\">\n                        <Calendar className=\"h-8 w-8 text-blue-600\" />\n                        <div>\n                            <h1 className=\"text-2xl font-bold text-gray-900\">Planning des Cours</h1>\n                            <p className=\"text-gray-600\">Votre emploi du temps hebdomadaire</p>\n                        </div>\n                    </div>\n                    \n                    {scheduleData?.weekDates && (\n                        <div className=\"text-right\">\n                            <p className=\"text-sm text-gray-600\">Semaine du</p>\n                            <p className=\"font-medium text-gray-900\">\n                                {new Date(scheduleData.weekDates.start).toLocaleDateString('fr-FR')} au {' '}\n                                {new Date(scheduleData.weekDates.end).toLocaleDateString('fr-FR')}\n                            </p>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Week Navigation */}\n            <div className=\"bg-white rounded-lg shadow p-4\">\n                <div className=\"flex items-center justify-between\">\n                    <button\n                        onClick={() => setCurrentWeek(w => w - 1)}\n                        className=\"px-4 py-2 text-blue-600 hover:text-blue-700 font-medium\"\n                    >\n                        ← Semaine précédente\n                    </button>\n                    \n                    <div className=\"flex items-center space-x-6\">\n                        <div className=\"text-center\">\n                            <p className=\"text-sm text-gray-600\">Cours cette semaine</p>\n                            <p className=\"text-2xl font-bold text-blue-600\">{totalClasses}</p>\n                        </div>\n                        <div className=\"text-center\">\n                            <p className=\"text-sm text-gray-600\">Étudiants total</p>\n                            <p className=\"text-2xl font-bold text-green-600\">{totalStudents}</p>\n                        </div>\n                    </div>\n                    \n                    <button\n                        onClick={() => setCurrentWeek(w => w + 1)}\n                        className=\"px-4 py-2 text-blue-600 hover:text-blue-700 font-medium\"\n                    >\n                        Semaine suivante →\n                    </button>\n                </div>\n            </div>\n\n            {/* Schedule Grid */}\n            <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n                {scheduleData?.schedule?.length ? (\n                    <div className=\"divide-y divide-gray-200\">\n                        {scheduleData.schedule.map((daySchedule) => (\n                            <div key={daySchedule.day} className=\"p-6\">\n                                <div className=\"flex items-center justify-between mb-4\">\n                                    <h3 className=\"text-lg font-semibold text-gray-900\">\n                                        {getDayName(daySchedule.day)}\n                                    </h3>\n                                    <span className=\"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm\">\n                                        {daySchedule.classes.length} cours\n                                    </span>\n                                </div>\n                                \n                                {daySchedule.classes.length > 0 ? (\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                                        {daySchedule.classes.map((class_) => (\n                                            <div\n                                                key={class_.id}\n                                                className=\"border border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:shadow-md transition-all\"\n                                            >\n                                                <div className=\"flex items-start justify-between mb-3\">\n                                                    <div>\n                                                        <h4 className=\"font-medium text-gray-900\">{class_.groupName}</h4>\n                                                        <p className=\"text-sm text-gray-600\">{class_.subject} - {class_.level}</p>\n                                                    </div>\n                                                    <span className={`px-2 py-1 rounded text-xs font-medium ${getTimeColor(class_.startTime)}`}>\n                                                        {class_.startTime} - {class_.endTime}\n                                                    </span>\n                                                </div>\n                                                \n                                                <div className=\"space-y-2\">\n                                                    <div className=\"flex items-center space-x-2 text-sm text-gray-500\">\n                                                        <Clock className=\"h-4 w-4\" />\n                                                        <span>{class_.startTime} - {class_.endTime}</span>\n                                                    </div>\n                                                    \n                                                    {class_.room && (\n                                                        <div className=\"flex items-center space-x-2 text-sm text-gray-500\">\n                                                            <MapPin className=\"h-4 w-4\" />\n                                                            <span>Salle {class_.room}</span>\n                                                        </div>\n                                                    )}\n                                                    \n                                                    <div className=\"flex items-center space-x-2 text-sm text-gray-500\">\n                                                        <Users className=\"h-4 w-4\" />\n                                                        <span>{class_.studentCount} étudiants</span>\n                                                    </div>\n                                                </div>\n                                                \n                                                <div className=\"mt-3 pt-3 border-t border-gray-100\">\n                                                    <button className=\"text-blue-600 hover:text-blue-700 text-sm font-medium\">\n                                                        Voir les détails →\n                                                    </button>\n                                                </div>\n                                            </div>\n                                        ))}\n                                    </div>\n                                ) : (\n                                    <div className=\"text-center py-8\">\n                                        <Calendar className=\"h-12 w-12 text-gray-300 mx-auto mb-3\" />\n                                        <p className=\"text-gray-500\">Aucun cours ce jour</p>\n                                    </div>\n                                )}\n                            </div>\n                        ))}\n                    </div>\n                ) : (\n                    <div className=\"text-center py-12\">\n                        <Calendar className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\n                        <p className=\"text-gray-500 text-lg\">Aucun cours programmé cette semaine</p>\n                    </div>\n                )}\n            </div>\n\n            {/* Legend */}\n            <div className=\"bg-white rounded-lg shadow p-6\">\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Légende des heures</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                    <div className=\"flex items-center space-x-2\">\n                        <div className=\"w-4 h-4 bg-blue-100 rounded\"></div>\n                        <span className=\"text-sm text-gray-600\">Matin (avant 12h)</span>\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                        <div className=\"w-4 h-4 bg-green-100 rounded\"></div>\n                        <span className=\"text-sm text-gray-600\">Après-midi (12h-16h)</span>\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                        <div className=\"w-4 h-4 bg-purple-100 rounded\"></div>\n                        <span className=\"text-sm text-gray-600\">Soir (après 16h)</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}